.\" $OpenBSD: skey.1,v 1.24 2004/06/04 18:18:20 otto Exp $
.\"	@(#)skey.1	1.1 	10/28/93
.\"
.Dd October 28, 1993
.Dt SKEY 1
.Os
.Sh NAME
.Nm skey, otp-md4, otp-md5, otp-sha1, otp-rmd160
.Nd respond to an OTP challenge
.Sh SYNOPSIS
.Nm skey
.Op Fl x
.Oo
.Fl md4 | Fl md5 | Fl sha1 |
.Fl rmd160
.Oc
.Op Fl n Ar count
.Op Fl p Ar passphrase
<sequence#>[/] key
.Sh DESCRIPTION
.Nm S/Key
is a procedure for using one-time passwords to authenticate access to
computer systems.
It uses 64 bits of information transformed by the
MD4, MD5, SHA1, or RIPEMD-160 algorithms.
The user supplies the 64 bits
in the form of 6 English words that are generated by a secure computer.
This implementation of
.Nm S/Key
is RFC 2289 compliant.
.Pp
Before using
.Nm skey
the system needs to be initialized using
.Xr skeyinit 1 ;
this will establish a secret passphrase.
After that, one-time passwords can be generated using
.Nm skey ,
which will prompt for the secret passphrase.
After a one-time password has been used to log in, it can no longer be used.
.Pp
When
.Nm skey
is invoked as
.Nm otp-method ,
.Nm skey
will use
.Ar method
as the hash function where
.Ar method
is currently one of md4, md5, sha1, or rmd160.
.Pp
If you misspell your secret passphrase while running
.Nm skey ,
you will get a list of one-time passwords
that will not work, and no indication of the problem.
.Pp
Password sequence numbers count backwards.
You can enter the passwords using small letters, even though
.Nm skey
prints them capitalized.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl n Ar count
Prints out
.Ar count
one-time passwords.
The default is to print one.
.It Fl p Ar passphrase
Uses
.Ar passphrase
as the secret passphrase.
Use of this option is discouraged as
your secret passphrase could be visible in a process listing.
.It Fl x
Causes output to be in hexadecimal instead of ASCII.
.It Fl md4
Selects MD4 as the hash algorithm.
.It Fl md5
Selects MD5 as the hash algorithm.
.It Fl sha1
Selects SHA-1 (NIST Secure Hash Algorithm Revision 1) as the hash algorithm.
.It Fl rmd160
Selects RMD-160 (160 bit Ripe Message Digest) as the hash algorithm.
.El
.Sh EXAMPLES
.sp 0
    % skey 99 th91334
.sp 0
    Enter secret passphrase: <your secret passphrase is entered here>
.sp 0
    OMEN US HORN OMIT BACK AHOY
.sp 0
    %
.Sh SEE ALSO
.Xr login 1 ,
.Xr skeyinfo 1 ,
.Xr skeyinit 1
.Pp
.Em RFC 2289
.Sh TRADEMARKS AND PATENTS
S/Key is a Trademark of Bellcore.
.Sh AUTHORS
Phil Karn, Neil M. Haller, John S. Walden, Scott Chasin
