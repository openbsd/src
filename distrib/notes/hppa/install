dnl	$OpenBSD: install,v 1.10 2004/05/04 23:59:39 deraadt Exp $
dnl lots of texts coming from {mac68k,mvme68k,vax}/install initially
OpenBSDInstallPrelude

Currently, the only way to bootstrap the installation procedure is
to boot the miniroot over the network.


Booting from Network:

In order to bootstrap via the network, you must provide a second system to
act as a boot server. It is convenient if this is a second OpenBSD machine
as the necessary services are already installed, although source code for
such programs as mopd can be found in OpenBSD's source tree, and should be
reasonably portable to other UN*X-like operating systems. More information
on diskless booting can be found in the OpenBSD diskless(8) manual page.

Your MACHINE expects to be able to download a so-called LIF (``Logical
Interchange Format'') image, containing both the boot code and the kernel,
via the HP rboot protocol, for older firmware, or via the bootp protocol,
for more recent firmware.

Old firmware operation

Models such as 7[035]5, 715/33/50/75, 725/50/75 have an older version
of PDC. There are two levels of interactive commands in this version.
The first level is a short menu:

	b)   Boot from specified device
	s)   Search for bootable device
	a)   Enter Boot Administration mode
	x)   Exit and continue boot sequence

	Select from menu:

In this case, you will need to setup rbootd on the server. Start by creating
an /etc/rbootd.conf file on the bootserver. The format of this file is the
ethernet address followed by the LIF filename. Here is an example:

	08:00:09:70:c4:11		lif{:--:}OSrev.fs

Then start rbootd (or configure /etc/rc.conf to always start rbootd). Once
rbootd is running, the server name will then appear on the MACHINE as part of
the possible boot choices in a boot device search (``s'' command).

Modern firmware operation

More recent machines mostly those based on the 7100LC, 7200 and 7300LC CPU
types have a different PDC version.  There is only one interactive mode,
with a BOOT_ADMIN> prompt, which provides both boot settings and commands.

In this case, you will need to set up dhcpd on the server, which can
serve bootp protocol requests.  Start by editing the /etc/dhcpd.conf on
the bootserver, and declare an information block. Here is an example:

	subnet 10.0.0.0 netmask 255.0.0.0 {
		host boron {
			filename "lif{:--:}OSrev.fs";
			hardware ethernet 08:00:09:70:c4:11;
			fixed-address 10.42.42.42;
		}
	}

Do not forget to enable dhcpd, either as a standalone process.

You will also need to enable tftpd, for the MACHINE to download the
miniroot (bf entry) from the server in the /tftpboot (td entry) directory.

Common operation

You are now ready to bootstrap the miniroot. On your MACHINE, escape to a
prompt and boot from the network by entering ``boot lan isl''. On old PDC
firmware, you will need to enter administration mode first.


Installing using the netboot procedure:

OpenBSDInstallPart2

	Boot your machine from the installation media as described above.

dnl mention slow cdrom someday
	It will take a while to load the miniroot image, especially from
	a slow network connection, most likely more than a minute.
	If some action doesn't eventually happen, or the spinning cursor
	has stopped and nothing further has happened, either your boot
	media is bad, your diskless setup is incorrect, or you may have
	a hardware or configuration problem.

	When presented with the boot prompt, simply press enter, or wait
	for the kernel to autoboot after 5 seconds.

OpenBSDBootMsgs

	You will next be asked for your terminal type.  If you are
	installing from a non-serial console, the default of "vt100"
	is correct.  If you are installing from a serial console
	you should choose the terminal type from amongst those listed.
	(If your terminal type is xterm, just use vt100).

OpenBSDInstallPart3

OpenBSDInstallPart4

	Since the target disk will become the boot disk for your new
	OpenBSD/MACHINE installation, the disklabel program will restrict
	the available disk area to keep the first cylinder, which will
	contain the bootblock, safe from being overwritten. If you don't
	plan to install a bootblock on this disk, you can reclaim this
	space with the 'b' command.

OpenBSDInstallPart5(sd0)

OpenBSDInstallNet({:-CD-ROM, -:},nofloppy)

OpenBSDFTPInstall

OpenBSDHTTPInstall

OpenBSDTAPEInstall

OpenBSDCDROMInstall

OpenBSDNFSInstall

OpenBSDDISKInstall(,{:-only -:})

OpenBSDCommonFS

OpenBSDCommonURL

OpenBSDCongratulations
